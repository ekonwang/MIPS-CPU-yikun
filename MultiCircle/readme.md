## 多周期处理器技术报告

*王艺坤 20 CS*

### Introduction



> 为什么需要多周期处理器？
>
> 1. 由于木桶效应，单周期处理器需要足够长的周期来完成最慢的指令。多周期将指令的执行分成多个较短的周期，以此尝试减少整体的执行时间：某些指令只需要更少的周期数，比如 `jne` 可以在 3 个周期内完成指令的执行。
> 2. 单周期处理器需要 3 个加法器 （ALU 中一个和 PC 更新中的两个），多周期可以复用 ALU 中的加法器来减小电路规模，从而降低成本。

#### 多周期处理器简介



### 总体实现

多周期处理器与单周期处理器在实现上的异同：

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/MultiCircleMIPS.png" style="zoom:50%;" />

1. 数据路径上，将体系结构状态元件和储存器与组合逻辑连接来创建一条数据路径。增加了非体系结构状态元件来保存每个步骤之间的中间结果。
2. 控制器，每个指令执行期间控制器针对不同的步骤上产生不同的指令，因此它现在是有限状态机而非组合电路。

#### 如何将指令执行分成时长更小的阶段

在多周期处理设计中，指令最长被分割成5个不同的阶段：

- IF，instruction fetching，取指阶段
- ID，instruction decode & register read，译码阶段
- EX，execute operation & calculate address，执行阶段
- MEM，access memory operand，读存阶段
- WB，write back，写回阶段

在之后流水线设计中，一个设计中重要的细节就是：`pc` 是何时更新的？

在多周期中，`pc` 可以在晚一点的阶段更新，但对于流水线处理器来说，上一条指令取指之后就确定 `pc` 是很重要的，因此 `pc` 应该在取指阶段完成更新。

















